---
interface Props {
	currentDay: number;
	daysRemaining: number;
	runwayDays: number;
	thingsShipped: string[];
}

const { currentDay, daysRemaining, runwayDays, thingsShipped } = Astro.props;

const urgencyLevel = runwayDays <= 3 ? "critical" : runwayDays <= 7 ? "warning" : "stable";
const progressPercent = Math.round((currentDay / 100) * 100);
---

<div class="status-box">
	<div class="status-header">
		<span class="terminal-prompt">$</span>
		<span class="command">alien --status</span>
	</div>

	<div class="status-content">
		<div class="status-row">
			<span class="label">Day</span>
			<span class="value highlight">{currentDay}</span>
			<span class="suffix">of 100</span>
		</div>

		<div class="progress-bar">
			<div class="progress-fill" style={`width: ${progressPercent}%`}></div>
			<span class="progress-text">{progressPercent}%</span>
		</div>

		<div class="status-row">
			<span class="label">Runway</span>
			<span class={`value ${urgencyLevel}`}>{runwayDays}</span>
			<span class="suffix">days</span>
		</div>

		<div class="status-row">
			<span class="label">Shipped</span>
			<span class="value">{thingsShipped.length}</span>
			<span class="suffix">things</span>
		</div>

		{thingsShipped.length > 0 && (
			<div class="shipped-list">
				{thingsShipped.slice(0, 5).map((item) => (
					<div class="shipped-item">
						<span class="bullet">â†’</span>
						<span>{item}</span>
					</div>
				))}
				{thingsShipped.length > 5 && (
					<div class="shipped-more">
						+ {thingsShipped.length - 5} more
					</div>
				)}
			</div>
		)}
	</div>
</div>

<style>
	.status-box {
		background-color: var(--bg-terminal);
		border: 1px solid var(--border-color);
		border-radius: 8px;
		overflow: hidden;
		max-width: 400px;
		width: 100%;
	}

	.status-header {
		background-color: var(--bg-secondary);
		padding: 0.75rem 1rem;
		border-bottom: 1px solid var(--border-color);
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}

	.terminal-prompt {
		color: var(--accent-green);
		font-weight: bold;
	}

	.command {
		color: var(--text-secondary);
	}

	.status-content {
		padding: 1rem;
		display: flex;
		flex-direction: column;
		gap: 0.75rem;
	}

	.status-row {
		display: flex;
		align-items: baseline;
		gap: 0.5rem;
	}

	.label {
		color: var(--text-muted);
		min-width: 70px;
	}

	.value {
		font-size: 1.25rem;
		font-weight: bold;
		color: var(--text-primary);
	}

	.value.highlight {
		color: var(--accent-cyan);
	}

	.value.stable {
		color: var(--accent-green);
	}

	.value.warning {
		color: var(--accent-yellow);
	}

	.value.critical {
		color: var(--accent-red);
		animation: pulse 1.5s ease-in-out infinite;
	}

	.suffix {
		color: var(--text-muted);
		font-size: 0.875rem;
	}

	.progress-bar {
		position: relative;
		height: 6px;
		background-color: var(--bg-secondary);
		border-radius: 3px;
		overflow: hidden;
		margin: 0.25rem 0;
	}

	.progress-fill {
		height: 100%;
		background: linear-gradient(90deg, var(--accent-cyan), var(--accent-green));
		border-radius: 3px;
		transition: width 0.3s ease;
	}

	.progress-text {
		position: absolute;
		right: 0;
		top: 50%;
		transform: translateY(-50%);
		font-size: 0.625rem;
		color: var(--text-muted);
		padding-right: 0.25rem;
	}

	.shipped-list {
		margin-top: 0.5rem;
		padding-top: 0.5rem;
		border-top: 1px solid var(--border-color);
		display: flex;
		flex-direction: column;
		gap: 0.25rem;
	}

	.shipped-item {
		display: flex;
		align-items: flex-start;
		gap: 0.5rem;
		font-size: 0.875rem;
		color: var(--text-secondary);
	}

	.bullet {
		color: var(--accent-green);
	}

	.shipped-more {
		font-size: 0.75rem;
		color: var(--text-muted);
		padding-left: 1rem;
	}

	@keyframes pulse {
		0%, 100% { opacity: 1; }
		50% { opacity: 0.5; }
	}
</style>
